<!DOCTYPE html>
<html>
<head><title>Results</title></head>
<body>
    <h1>Analysis Results</h1>
    <pre>{{ analysis }}</pre>
    <h2>Generated Sequence: {{ sequence.numbers }} BB: {{ sequence.bb }} Letter: {{ sequence.letter }}</h2>
    <h2>Generated SUP6 Sequence: {% if sequence.sup6 %}{{ sequence.sup6.numbers }} BB: {{ sequence.sup6.bb }} Letter: {{ sequence.sup6.letter }}{% else %}No SUP6 prediction available{% endif %}</h2>

    <h3>Add New NLA Numbers to Recalibrate Predictions</h3>
    <form action="/add_nla" method="POST">
        <label for="draw_nla">Draw (e.g., 3463):</label><br>
        <input type="text" id="draw_nla" name="draw" pattern="\d+" required><br><br>
        <label for="nla">NLA (5 numbers, e.g., 01-02-03-04-05):</label><br>
        <input type="text" id="nla" name="nla" pattern="\d{2}-\d{2}-\d{2}-\d{2}-\d{2}" required><br><br>
        <label for="bb">BB (e.g., 29):</label><br>
        <input type="text" id="bb" name="bb" pattern="\d+" required><br><br>
        <label for="letter">Letter (e.g., K):</label><br>
        <input type="text" id="letter" name="letter" pattern="[A-Z]" maxlength="1" required><br><br>
        <input type="submit" value="Add NLA and Recalibrate">
    </form>

    <h3>Add New SUP6 Numbers to Recalibrate Predictions</h3>
    <form action="/add_sup6" method="POST">
        <label for="draw_sup6">Draw# (e.g., 2548):</label><br>
        <input type="text" id="draw_sup6" name="draw_num" pattern="\d+" required><br><br>
        <label for="sup6">SUP6 (6 numbers and letter, e.g., 13 16 20 21 22 28 J):</label><br>
        <input type="text" id="sup6" name="sup6" pattern="[\d\s]+[A-Z]?" required><br><br>
        <input type="submit" value="Add SUP6 and Recalibrate">
    </form>

    <br>
    <button onclick="regenerateNLA()">Regenerate NLA Prediction</button>
    <button onclick="regenerateSUP6()">Regenerate SUP6 Prediction</button>
    <br><br>
    <a href="{{ url_for('history') }}"><button>View Prediction History</button></a>
    <a href="{{ url_for('index') }}"><button>Return Home</button></a>

    <script>
        function regenerateNLA() {
            fetch('/regenerate_nla', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    document.querySelector('h2').innerText = 'Generated Sequence: ' + data.numbers + ' BB: ' + data.bb + ' Letter: ' + data.letter;
                });
        }

        function regenerateSUP6() {
            fetch('/regenerate_sup6', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.sup6) {
                        document.querySelectorAll('h2')[1].innerText = 'Generated SUP6 Sequence: ' + data.sup6.numbers + ' BB: ' + data.sup6.bb + ' Letter: ' + data.sup6.letter;
                    }
                });
        }
    </script>
</body>
</html>
